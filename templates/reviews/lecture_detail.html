{% extends 'reviews/base.html' %}
{% block title %}{{ lecture.title }}{% endblock %}

{% block content %}
<div class="card mb-4">
  <div class="card-body">
    <h2 class="card-title">{{ lecture.title }}</h2>
    <p class="card-text">{{ lecture.description }}</p>
  </div>
</div>

<h4>å­¦ç”Ÿã®ãƒ¬ãƒ“ãƒ¥ãƒ¼</h4>

{% for review in reviews %}
  <div class="card mb-2">
    <div class="card-body">
      <h6 class="card-subtitle mb-2 text-muted">
        {{ review.user }}ï¼ˆ{{ review.rating }}ç‚¹ï¼‰
      </h6>
      <p class="card-text">{{ review.comment }}</p>

      {% if review.user == user %}
        <a href="{% url 'review_edit' review.id %}" class="btn btn-sm btn-outline-primary">ç·¨é›†</a>
        <a href="{% url 'review_delete' review.id %}" class="btn btn-sm btn-outline-danger">å‰Šé™¤</a>
      {% endif %}
    </div>
  </div>
{% empty %}
  <p>ã¾ã ãƒ¬ãƒ“ãƒ¥ãƒ¼ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
{% endfor %}

{% if user.is_authenticated %}
  <a href="{% url 'review_create' lecture.id %}" class="btn btn-success mt-3">
    ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’æ›¸ã
  </a>
{% else %}
  <a href="{% url 'login' %}" class="btn btn-secondary mt-3">
    ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’æ›¸ã
  </a>
{% endif %}
{% endblock %}

<p>
  è©•ä¾¡ï¼š
  {% for i in "12345" %}
    {% if forloop.counter <= review.rating %}
      <span class="text-warning">â˜…</span>
    {% else %}
      <span class="text-muted">â˜†</span>
    {% endif %}
  {% endfor %}
</p>

<form method="post" action="{% url 'lecture_like' lecture.id %}">
  {% csrf_token %}
  <button class="btn btn-outline-primary btn-sm">
    ğŸ‘ ã„ã„ã­ {{ lecture.likes.count }}
  </button>
</form>

{% for review in reviews %}
  <div class="card mb-2">
    <div class="card-body">
      <p>{{ review.comment }}</p>

      {% if review.id in liked_review_ids %}
        <button class="btn btn-secondary btn-sm" disabled>
          ğŸ‘ {{ review.likes.count }}
        </button>
      {% else %}
        <form method="post" action="{% url 'review_like' review.id %}">
          {% csrf_token %}
          <button class="btn btn-outline-secondary btn-sm">
            ğŸ‘ {{ review.likes.count }}
          </button>
        </form>
      {% endif %}
    </div>
  </div>
{% endfor %}

<form method="post" action="{% url 'lecture_like' lecture.id %}">
  {% csrf_token %}
  <button class="btn btn-sm
    {% if liked_lecture %}btn-danger{% else %}btn-outline-danger{% endif %}">
    â¤ï¸ {{ lecture.like_set.count }}
  </button>
</form>
